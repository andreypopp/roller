#!/usr/bin/env node
var crush       = require('./index')
var JSONStream  = require('JSONStream')
var program     = require('commander')

program
  .version('0.1.0')
  .option('-t --transform <transform>', 'transform to apply')
  .parse(process.argv)

var results = crush(program.args[0], {
  transform: program.transform
})

results.on('error', function(err) {
  console.log(err.message || err)
  process.exit(1)
})

results
  .pipe(JSONStream.stringify())
  .pipe(process.stdout)
